import{c as B,v as K,r as x,d as Q,b as X,j as r,H as E,L as M,s as Y}from"./index-CuLUR7ue.js";import{N as k,b as Z}from"./Navbar-DUxwz1eI.js";import{h as ee}from"./hoist-non-react-statics.cjs-BgISz65J.js";import{C as te}from"./user-CLQm5Qt5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=B("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=B("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var C={exports:{}},T,V;function ae(){if(V)return T;V=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return T=n,T}var P,$;function ie(){if($)return P;$=1;var n=ae();function i(){}function a(){}return a.resetWarningCache=i,P=function(){function e(y,j,h,b,u,o){if(o!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}e.isRequired=e;function t(){return e}var c={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return c.PropTypes=c,c},P}var G;function se(){return G||(G=1,C.exports=ie()()),C.exports}var oe=se();const p=K(oe);var ce=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function I(){return I=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(n[e]=a[e])}return n},I.apply(this,arguments)}function de(n,i){if(n==null)return{};var a={},e=Object.keys(n),t,c;for(c=0;c<e.length;c++)t=e[c],!(i.indexOf(t)>=0)&&(a[t]=n[t]);return a}function S(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function le(n,i){n.prototype=Object.create(i.prototype),n.prototype.constructor=n,A(n,i)}function A(n,i){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(n,i)}var L=function(n){le(i,n);function i(){var e;return e=n.call(this)||this,e.handleExpired=e.handleExpired.bind(S(e)),e.handleErrored=e.handleErrored.bind(S(e)),e.handleChange=e.handleChange.bind(S(e)),e.handleRecaptchaRef=e.handleRecaptchaRef.bind(S(e)),e}var a=i.prototype;return a.getCaptchaFunction=function(t){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[t]:this.props.grecaptcha[t]:null},a.getValue=function(){var t=this.getCaptchaFunction("getResponse");return t&&this._widgetId!==void 0?t(this._widgetId):null},a.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},a.execute=function(){var t=this.getCaptchaFunction("execute");if(t&&this._widgetId!==void 0)return t(this._widgetId);this._executeRequested=!0},a.executeAsync=function(){var t=this;return new Promise(function(c,y){t.executionResolve=c,t.executionReject=y,t.execute()})},a.reset=function(){var t=this.getCaptchaFunction("reset");t&&this._widgetId!==void 0&&t(this._widgetId)},a.forceReset=function(){var t=this.getCaptchaFunction("reset");t&&t()},a.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},a.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},a.handleChange=function(t){this.props.onChange&&this.props.onChange(t),this.executionResolve&&(this.executionResolve(t),delete this.executionReject,delete this.executionResolve)},a.explicitRender=function(){var t=this.getCaptchaFunction("render");if(t&&this._widgetId===void 0){var c=document.createElement("div");this._widgetId=t(c,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(c)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},a.componentDidMount=function(){this.explicitRender()},a.componentDidUpdate=function(){this.explicitRender()},a.handleRecaptchaRef=function(t){this.captcha=t},a.render=function(){var t=this.props;t.sitekey,t.onChange,t.theme,t.type,t.tabindex,t.onExpired,t.onErrored,t.size,t.stoken,t.grecaptcha,t.badge,t.hl,t.isolated;var c=de(t,ce);return x.createElement("div",I({},c,{ref:this.handleRecaptchaRef}))},i}(x.Component);L.displayName="ReCAPTCHA";L.propTypes={sitekey:p.string.isRequired,onChange:p.func,grecaptcha:p.object,theme:p.oneOf(["dark","light"]),type:p.oneOf(["image","audio"]),tabindex:p.number,onExpired:p.func,onErrored:p.func,size:p.oneOf(["compact","normal","invisible"]),stoken:p.string,hl:p.string,badge:p.oneOf(["bottomright","bottomleft","inline"]),isolated:p.bool};L.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};function U(){return U=Object.assign||function(n){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(n[e]=a[e])}return n},U.apply(this,arguments)}function pe(n,i){if(n==null)return{};var a={},e=Object.keys(n),t,c;for(c=0;c<e.length;c++)t=e[c],!(i.indexOf(t)>=0)&&(a[t]=n[t]);return a}function he(n,i){n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.__proto__=i}var g={},ue=0;function fe(n,i){return i=i||{},function(e){var t=e.displayName||e.name||"Component",c=function(j){he(h,j);function h(u,o){var s;return s=j.call(this,u,o)||this,s.state={},s.__scriptURL="",s}var b=h.prototype;return b.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+ue++),this.__scriptLoaderID},b.setupScriptURL=function(){return this.__scriptURL=typeof n=="function"?n():n,this.__scriptURL},b.asyncScriptLoaderHandleLoad=function(o){var s=this;this.setState(o,function(){return s.props.asyncScriptOnLoad&&s.props.asyncScriptOnLoad(s.state)})},b.asyncScriptLoaderTriggerOnScriptLoaded=function(){var o=g[this.__scriptURL];if(!o||!o.loaded)throw new Error("Script is not loaded.");for(var s in o.observers)o.observers[s](o);delete window[i.callbackName]},b.componentDidMount=function(){var o=this,s=this.setupScriptURL(),d=this.asyncScriptLoaderGetScriptLoaderID(),f=i,N=f.globalName,l=f.callbackName,R=f.scriptId;if(N&&typeof window[N]<"u"&&(g[s]={loaded:!0,observers:{}}),g[s]){var v=g[s];if(v&&(v.loaded||v.errored)){this.asyncScriptLoaderHandleLoad(v);return}v.observers[d]=function(m){return o.asyncScriptLoaderHandleLoad(m)};return}var D={};D[d]=function(m){return o.asyncScriptLoaderHandleLoad(m)},g[s]={loaded:!1,observers:D};var w=document.createElement("script");w.src=s,w.async=!0;for(var H in i.attributes)w.setAttribute(H,i.attributes[H]);R&&(w.id=R);var q=function(_){if(g[s]){var J=g[s],O=J.observers;for(var W in O)_(O[W])&&delete O[W]}};l&&typeof window<"u"&&(window[l]=function(){return o.asyncScriptLoaderTriggerOnScriptLoaded()}),w.onload=function(){var m=g[s];m&&(m.loaded=!0,q(function(_){return l?!1:(_(m),!0)}))},w.onerror=function(){var m=g[s];m&&(m.errored=!0,q(function(_){return _(m),!0}))},document.body.appendChild(w)},b.componentWillUnmount=function(){var o=this.__scriptURL;if(i.removeOnUnmount===!0)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d+=1)s[d].src.indexOf(o)>-1&&s[d].parentNode&&s[d].parentNode.removeChild(s[d]);var f=g[o];f&&(delete f.observers[this.asyncScriptLoaderGetScriptLoaderID()],i.removeOnUnmount===!0&&delete g[o])},b.render=function(){var o=i.globalName,s=this.props;s.asyncScriptOnLoad;var d=s.forwardedRef,f=pe(s,["asyncScriptOnLoad","forwardedRef"]);return o&&typeof window<"u"&&(f[o]=typeof window[o]<"u"?window[o]:void 0),f.ref=d,x.createElement(e,f)},h}(x.Component),y=x.forwardRef(function(j,h){return x.createElement(c,U({},j,{forwardedRef:h}))});return y.displayName="AsyncScriptLoader("+t+")",y.propTypes={asyncScriptOnLoad:p.func},ee(y,e)}}var F="onloadcallback",me="grecaptcha";function z(){return typeof window<"u"&&window.recaptchaOptions||{}}function xe(){var n=z(),i=n.useRecaptchaNet?"recaptcha.net":"www.google.com";return n.enterprise?"https://"+i+"/recaptcha/enterprise.js?onload="+F+"&render=explicit":"https://"+i+"/recaptcha/api.js?onload="+F+"&render=explicit"}const be=fe(xe,{callbackName:F,globalName:me,attributes:z().nonce?{nonce:z().nonce}:{}})(L),Re=()=>{const{user:n,loading:i}=Q(),[a,e]=x.useState(0),[t,c]=x.useState(0),[y,j]=x.useState(""),[h,b]=x.useState(!1),[u,o]=x.useState(null),{toast:s}=X(),d=x.useRef(null),f=async()=>{if(!n){s({title:"خطأ",description:"يجب تسجيل الدخول أولاً",variant:"destructive"});return}if(a===0){s({title:"خطأ",description:"يرجى اختيار تقييم",variant:"destructive"});return}if(!u){s({title:"تحقق من CAPTCHA",description:"الرجاء التحقق من أنك لست روبوت",variant:"destructive"});return}b(!0);try{const{error:l}=await Y.from("feedback").upsert({user_id:n.id,rating:a,comment:y.trim()||null});if(l)throw l;s({title:"شكراً لك!",description:"تم إرسال تقييمك بنجاح"}),e(0),j(""),d.current&&(d.current.reset(),o(null))}catch(l){console.error("Error submitting feedback:",l);let R="فشل في إرسال التقييم";l instanceof Error&&(R=l.message),s({title:"خطأ",description:R,variant:"destructive"})}finally{b(!1)}},N=()=>Array.from({length:5},(l,R)=>{const v=R+1;return r.jsx("button",{onClick:()=>e(v),onMouseEnter:()=>c(v),onMouseLeave:()=>c(0),className:"transition-colors",disabled:h,"aria-label":`تقييم ${v} نجوم`,children:r.jsx(Z,{size:32,className:`${v<=(t||a)?"fill-yellow-400 text-yellow-400":"text-gray-300"} hover:text-yellow-400`})},R)});return i?r.jsxs("div",{dir:"rtl",className:"min-h-screen bg-gradient-to-b from-amber-50 to-orange-50",children:[r.jsx(E,{children:r.jsx("title",{children:"جاري التحميل - التقييم"})}),r.jsx(k,{}),r.jsxs("div",{className:"container mx-auto px-6 py-20 text-center",children:[r.jsx(M,{className:"mx-auto mb-4 text-amber-700 animate-spin",size:48}),r.jsx("p",{className:"text-xl text-amber-700",children:"جاري التحقق من الجلسة..."})]})]}):n?r.jsxs("div",{dir:"rtl",className:"min-h-screen bg-gradient-to-b from-amber-50 to-orange-50",children:[r.jsx(E,{children:r.jsx("title",{children:"تقييم الخدمة - قهوة دمنهور"})}),r.jsx(k,{}),r.jsxs("div",{className:"container mx-auto px-6 py-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx(re,{className:"mx-auto mb-4 text-amber-700",size:48}),r.jsx("h1",{className:"text-3xl font-bold text-amber-900",children:"تقييم الخدمة"}),r.jsx("p",{className:"text-amber-700 mt-2",children:"رأيك يهمنا! شاركنا تجربتك مع قهوة دمنهور"})]}),r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-amber-900 mb-4",children:"كيف تقيم خدماتنا؟"}),r.jsx("div",{className:"flex justify-center space-x-2 space-x-reverse mb-4",children:N()}),a>0&&r.jsxs("p",{className:"text-amber-700",children:[a===1&&"سيء جداً",a===2&&"سيء",a===3&&"متوسط",a===4&&"جيد",a===5&&"ممتاز"]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-amber-800 font-medium mb-2",children:"شاركنا تجربتك (اختياري)"}),r.jsx("textarea",{value:y,onChange:l=>j(l.target.value),className:"w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 resize-none",rows:5,placeholder:"أخبرنا عن تجربتك مع قهوة دمنهور... ما الذي أعجبك؟ ما الذي يمكننا تحسينه؟",disabled:h})]}),r.jsx("div",{className:"mb-6 flex justify-center",children:r.jsx(be,{ref:l=>{d.current=l},sitekey:"6LeVp1QrAAAAAIeHUUPGMX6__lEu8aJyjpZA16OU",onChange:o})}),r.jsxs("button",{onClick:f,disabled:h||a===0||!u,className:"w-full flex items-center justify-center space-x-2 space-x-reverse bg-amber-600 text-white py-3 rounded-lg hover:bg-amber-700 transition-colors font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:[h?r.jsx(M,{className:"animate-spin mr-2",size:20}):r.jsx(ne,{size:20,className:"mr-2"}),r.jsx("span",{children:h?"جاري الإرسال...":"إرسال التقييم"})]})]}),r.jsxs("div",{className:"mt-8 bg-white rounded-lg shadow-md p-6",children:[r.jsx("h3",{className:"text-lg font-bold text-amber-900 mb-4",children:"طرق التواصل الأخرى"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-white text-sm",children:"📱"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-amber-900",children:"واتساب"}),r.jsx("button",{onClick:()=>window.open("https://wa.me/+201229204276?text=مرحباً، أريد التواصل معكم","_blank"),className:"text-green-600 hover:underline",children:"+201229204276"})]})]}),r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-white text-sm",children:"📧"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-amber-900",children:"البريد الإلكتروني"}),r.jsx("a",{href:"mailto:damanhourcoffee@gmail.com",className:"text-blue-600 hover:underline",children:"damanhourcoffee@gmail.com"})]})]})]})]})]})]})]}):r.jsxs("div",{dir:"rtl",className:"min-h-screen bg-gradient-to-b from-amber-50 to-orange-50",children:[r.jsx(E,{children:r.jsx("title",{children:"تسجيل الدخول مطلوب - التقييم"})}),r.jsx(k,{}),r.jsxs("div",{className:"container mx-auto px-6 py-20 text-center",children:[r.jsx(te,{className:"mx-auto mb-4 text-amber-700",size:64}),r.jsx("h2",{className:"text-2xl font-bold text-amber-900 mb-4",children:"يجب تسجيل الدخول أولاً"}),r.jsx("p",{className:"text-amber-700 mb-6",children:"سجل دخولك لتتمكن من تقييم خدماتنا"}),r.jsx("a",{href:"/auth",className:"bg-amber-600 text-white px-6 py-3 rounded-lg hover:bg-amber-700 transition-colors",children:"تسجيل الدخول"})]})]})};export{Re as default};
